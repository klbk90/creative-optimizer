# üß™ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env`

–§–∞–π–ª `.env` —É–∂–µ —Å–æ–∑–¥–∞–Ω —Å —à–∞–±–ª–æ–Ω–æ–º. –û—Ç–∫—Ä–æ–π—Ç–µ –µ–≥–æ –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:

```bash
nano .env
# –∏–ª–∏
code .env
```

### 2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

#### –î–ª—è —Ä–∞–±–æ—Ç—ã API (–º–∏–Ω–∏–º—É–º):
- `DATABASE_URL` - —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –¥–ª—è docker-compose
- `REDIS_URL` - —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –¥–ª—è docker-compose
- `JWT_SECRET_KEY` - —É–∂–µ –µ—Å—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–∑–∞–º–µ–Ω–∏—Ç–µ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ!)

#### –î–ª—è —Ä–∞–±–æ—Ç—ã Admin Bot:
- `ADMIN_BOT_TOKEN` - –ø–æ–ª—É—á–∏—Ç–µ –æ—Ç [@BotFather](https://t.me/BotFather)
- `ADMIN_IDS` - –≤–∞—à Telegram ID (–ø–æ–ª—É—á–∏—Ç–µ –æ—Ç [@userinfobot](https://t.me/userinfobot))

#### –î–ª—è AI —Ñ–∏—á–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
- `ANTHROPIC_API_KEY` - –¥–ª—è AI-–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- `REPLICATE_API_TOKEN` - –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

```bash
python check_env.py
```

–°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç, –∫–∞–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã, –∞ –∫–∞–∫–∏–µ –Ω–µ—Ç.

### 4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É

```bash
# –ó–∞–ø—É—Å–∫ PostgreSQL + Redis
docker-compose up -d postgres redis

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
docker-compose ps
```

### 5. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
# –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö (–ø–µ—Ä–≤—ã–π —Ä–∞–∑)
alembic upgrade head
```

### 6. –ó–∞–ø—É—Å—Ç–∏—Ç–µ API

```bash
# –í –æ–¥–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
uvicorn api.main:app --reload --host 0.0.0.0 --port 8000
```

API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –Ω–∞: http://localhost:8000

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: http://localhost:8000/docs

### 7. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Admin Bot (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```bash
# –í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
python bots/admin_bot.py
```

---

## –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose (–≤—Å–µ –≤–º–µ—Å—Ç–µ)

–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± - –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã —Å—Ä–∞–∑—É:

```bash
# –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose up --build

# –ò–ª–∏ –≤ —Ñ–æ–Ω–µ
docker-compose up -d
```

–≠—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç:
- PostgreSQL (–ø–æ—Ä—Ç 5432)
- Redis (–ø–æ—Ä—Ç 6379)
- API (–ø–æ—Ä—Ç 8000)
- Admin Bot

---

## –§–∞–π–ª—ã –æ–∫—Ä—É–∂–µ–Ω–∏—è

### `.env` (–ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)
- **–ù–ï** –∫–æ–º–º–∏—Ç–∏—Ç—Å—è –≤ git
- –°–æ–¥–µ—Ä–∂–∏—Ç –≤–∞—à–∏ —Ä–µ–∞–ª—å–Ω—ã–µ –∫–ª—é—á–∏ –∏ —Ç–æ–∫–µ–Ω—ã
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### `.env.test` (–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- –ú–æ–∂–Ω–æ –∫–æ–º–º–∏—Ç–∏—Ç—å –≤ git
- –°–æ–¥–µ—Ä–∂–∏—Ç mock-–∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —Ç–µ—Å—Ç–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è pytest –∏ CI/CD

### `.env.example` (—à–∞–±–ª–æ–Ω)
- –ö–æ–º–º–∏—Ç–∏—Ç—Å—è –≤ git
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω—É–∂–Ω—ã
- –ù–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

---

## –ü–æ–ª—É—á–µ–Ω–∏–µ API –∫–ª—é—á–µ–π

### Telegram Bot Token
1. –û—Ç–∫—Ä–æ–π—Ç–µ [@BotFather](https://t.me/BotFather)
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/newbot`
3. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω –≤ `.env` ‚Üí `ADMIN_BOT_TOKEN`

### –í–∞—à Telegram ID
1. –û—Ç–∫—Ä–æ–π—Ç–µ [@userinfobot](https://t.me/userinfobot)
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start`
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–∞—à ID –≤ `.env` ‚Üí `ADMIN_IDS`

### Anthropic API Key
1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ [console.anthropic.com](https://console.anthropic.com)
2. –°–æ–∑–¥–∞–π—Ç–µ API –∫–ª—é—á
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤ `.env` ‚Üí `ANTHROPIC_API_KEY`

### Google Custom Search (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
1. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –≤ `GOOGLE_SEARCH_SETUP.md`
2. –ü–æ–ª—É—á–∏—Ç–µ API Key –∏ CX ID

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
# PostgreSQL
docker exec -it utm-postgres pg_isready -U utm_user

# Redis
docker exec -it utm-redis redis-cli ping

# API
curl http://localhost:8000/api/v1/health
```

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
pip install pytest pytest-asyncio httpx

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã —Å —Ç–µ—Å—Ç–æ–≤—ã–º –æ–∫—Ä—É–∂–µ–Ω–∏–µ–º
export ENV_FILE=.env.test
pytest

# –ò–ª–∏ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
pytest --cov=api --cov-report=html
```

---

## Troubleshooting

### –ü–æ—Ä—Ç—ã –∑–∞–Ω—è—Ç—ã
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ—Ä—Ç—ã —Å–≤–æ–±–æ–¥–Ω—ã
lsof -i :5432  # PostgreSQL
lsof -i :6379  # Redis
lsof -i :8000  # API

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –¥—Ä—É–≥–∏–µ —Å–µ—Ä–≤–∏—Å—ã –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç—ã –≤ docker-compose.yml
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è
```bash
# –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose down -v
docker-compose up -d

# –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏
alembic upgrade head
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–µ–∫—É—â—É—é –≤–µ—Ä—Å–∏—é
alembic current

# –û—Ç–∫–∞—Ç–∏—Ç–µ –∏ –Ω–∞–∫–∞—Ç–∏—Ç–µ –∑–∞–Ω–æ–≤–æ
alembic downgrade base
alembic upgrade head
```

---

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f api
docker-compose logs -f admin-bot

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
docker-compose restart api

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose down

# –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ (–≤–∫–ª—é—á–∞—è volumes)
docker-compose down -v

# –í—Ö–æ–¥ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker exec -it utm-api /bin/bash
docker exec -it utm-postgres psql -U utm_user -d utm_tracking
```

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚ö†Ô∏è **–í–ê–ñ–ù–û:**

1. **–ù–ò–ö–û–ì–î–ê** –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ `.env` —Ñ–∞–π–ª —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∫–ª—é—á–∞–º–∏
2. –ò–∑–º–µ–Ω–∏—Ç–µ `JWT_SECRET_KEY` –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–æ–º
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–ª—å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ –¥–ª—è –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
4. –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ API —á–µ—Ä–µ–∑ firewall
5. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

1. ‚úÖ –ò–∑—É—á–∏—Ç–µ API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é: http://localhost:8000/docs
2. ‚úÖ –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ `/api/v1/auth/register`
3. ‚úÖ –ü–æ–ª—É—á–∏—Ç–µ JWT —Ç–æ–∫–µ–Ω —á–µ—Ä–µ–∑ `/api/v1/auth/login`
4. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ admin –±–æ—Ç–∞ –∏ –¥–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–π ID
5. ‚úÖ –°–æ–∑–¥–∞–π—Ç–µ UTM –∫–∞–º–ø–∞–Ω–∏–∏ —á–µ—Ä–µ–∑ –±–æ—Ç–∞ –∏–ª–∏ API
6. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ landing pages

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [README.md](./README.md) - –æ—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [CHANGELOG.md](./CHANGELOG.md) - –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
- [API Documentation](http://localhost:8000/docs) - Swagger UI

---

**–í–æ–ø—Ä–æ—Å—ã?** –°–æ–∑–¥–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏!
